14. Find the total number of couriers handled by each employee:

Select E.EmployeeID, E.Name, Count(C.CourierID) as TotalCouriers
From Employee E
Join Courier C on E.Name = C.SenderName 
Group by E.EmployeeID, E.Name;

15. Calculate the total revenue generated by each location:

Select L.LocationID, L.LocationName, Sum(P.Amount) as TotalRevenue
From Location L
Join Payment P on L.LocationID = P.LocationID
Group  by L.LocationID, L.LocationName;


16. Find the total number of couriers delivered to each location:

Select L.locationid, L.locationname, Count(C.courierid) As Totaldelivered
From Location L
Join Payment P On L.locationid = P.locationid
Join Courier C On P.courierid = C.courierid
Where C.status = 'delivered'
Group By L.locationid, L.locationname;

17. Find the courier with the highest average delivery time:

Select C.courierid, C.trackingnumber, Avg(Datediff(C.deliverydate, Now())) As Avgdeliverytime
From Courier C
Where C.status = 'delivered'
Group By C.courierid, C.trackingnumber
Order By Avgdeliverytime Desc
Limit 1;

18. Find Locations with Total Payments Less Than a Certain Amount:

Select L.locationid, L.locationname, Sum(P.amount) As Totalpayments
From Location L
Join Payment P On L.locationid = P.locationid
Group By L.locationid, L.locationname
Having Totalpayments < 1000.00;  

19. Calculate Total Payments per Location:

Select L.locationid, L.locationname, Sum(P.amount) As Totalpayments
From Location L
Join Payment P On L.locationid = P.locationid
Group By L.locationid, L.locationname;

20. Retrieve couriers who have received payments totaling more than $1000 in a specific location

Select C.courierid, C.trackingnumber, Sum(P.amount) As Totalpayments
From Courier C
Join Payment P On C.courierid = P.courierid
Where P.locationid = 5  
Group By C.courierid, C.trackingnumber
Having Totalpayments > 1000.00;

21. Retrieve couriers who have received payments totaling more than $1000 after a certain date

Select C.courierid, C.trackingnumber, Sum(P.amount) As Totalpayments
From Courier C
Join Payment P On C.courierid = P.courierid
Where P.paymentdate > '2025-01-01'  
Group By C.courierid, C.trackingnumber
Having Totalpayments > 1000.00;

22. Retrieve locations where the total amount received is more than $5000 before a certain date

Select L.locationid, L.locationname, Sum(P.amount) As Totalpayments
From Location L
Join Payment P On L.locationid = P.locationid
Where P.paymentdate < '2025-01-01' 
Group By L.locationid, L.locationname
Having Totalpayments > 5000.00;



